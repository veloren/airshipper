code-quality:
  stage: check
  timeout: 2h
  except:
    - master
  image: registry.gitlab.com/veloren/veloren-docker-ci/cache/quality:${CACHE_IMAGE_TAG}
  tags: ["veloren/*", "check"]
  script:
    - cargo clippy --all-targets --locked --all-features -- -D warnings
    - cargo fmt --all -- --check
    - cargo test --all-features
